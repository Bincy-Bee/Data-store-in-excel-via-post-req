<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Datasheet</title>
</head>

<body>
    <!-- action="/addDatatoExcel" method="post" -->
    <form id="studentform">
        <input type="text" id="fname" name="fname" placeholder="Enter First Name"><br><br>
        <input type="text" id="lname" name="lname" placeholder="Enter Last Name"><br><br>
        <input type="email" id="email" name="email" placeholder="Enter Email"><br><br>
        <input type="text" id="grid" name="grid" placeholder="Enter GRID"><br><br>
        <input type="submit" name="" value="Save"><br><br>
    </form>
</body>
<script>
    // const scriptURL = '/addDatatoExcel';
    const form = document.getElementById("studentform");

    form.addEventListener('submit', (e) => {
        e.preventDefault()
        let obj = {
            fname : document.getElementById("fname").value,
            lname : document.getElementById("lname").value,
            email : document.getElementById("email").value,
            grid : document.getElementById("grid").value
        }
        fetch('/addDatatoExcel', { 
            method: 'POST',
            headers : {"content-type":"application/json"},
            body: JSON.stringify(obj) })
            .then((response) =>alert("Thank you! your form is submitted successfully." ))
            .then((data) => { window.location.reload()})
            .catch(error => console.error('Error!', error.message))
    })



    // async function sendData() {
    //     const formData = new FormData(form);
    //     try {
    //         const response = await fetch("/addDatatoExcel", {
    //             method: "POST",
    //             body: formData,
    //         });
    //         const data = await response.json();
    //         console.log(data);
    //     } catch (e) {
    //         console.error(e);
    //     }
    // }

    // // Take over form submission
    // form.addEventListener("submit", (event) => {
    //     event.preventDefault();
    //     sendData();
    // });
</script>

</html>